## Pixy CMUCAM5 Image Sensor Lego
Is a vision as a sensor, which means it is a camera with a microcontroller onboard. The microcontroller then uses a blob algorithm to detect objects based of colors. The result of the microcontroller is then either communicated via SPI, I2C, UART, USB or analog/digital output interfaces. The output is simply a data object that contains the (x,y)-coordinates of the recognized object, the size of the boundary box sorrounding the object, and which color label ie. which object it is.[^Pixy_Lego_wiki]

This means that even tho the Pixy CMUCAM5 has a lot of capabilities that would be benificial for the group, such as 50 fps object recognition, we can not use it in our project. Due to the fact that we actually need to recognize the 'value' of a speed sign, and since there is no color coded differences between the speed signs, couple with the fact that the Pixy dont actually transmit any pixel data it would be impossible to detect the speed signs using the Pixy camera. 

### Alternative solutions
Since the Pixy CMUCAM5 was the only vision sensor/ camera that the university could supply for the Ev3 platform, the group started to look for alternative solutions. It quickly became clear to the group that since the Ev3 is a linux based system, and it has a usb 1.1 port it proberly would be possible to use a ordinary webcam, with a little tinkering. It turns out that this in fact was the case, Gabriel Ferrer a Professor of Computer Science at Hendrix College in Conway, Arkansas showcased a elegant solution for this on his blog back in 2014[^Webcam_with_Lego_Mindstorms_EV3]. Ferrer did it using leJos, which is a tiny Java Virtual Machine that runs on the Ev3 platform. Ferrer was able to connect a webcam to the Ev3 by carefully configure leJos and writing a driver for the camera which allowed for the Java code to interface with it. But since leJOS EV3 0.9.1 release from 2015[^lejos_091_release] the ablility to interface with webcams are natively support on the platform, along side another potential usefull tool which is OpenCV.

## leJos and webcam
Since leJos specifies that not all webcams are supported, the group collected a set of webcams to test them and locate one that would work. The group formulated two tests, the first one was wether or not the camera would be supported by the leJos webcam API. The second test was wether or not the webcam would be supported by the OpenCV webcam API, it was a requirement for the group that both tests should be succesfull before the camera could be rendered useable. 

The first two cameras was unsuccefull, the first one was suspected to fail because of the camera being broken. The second one failed since the leJos API could not interface with it, which most likely were due to the fact, that the camera was a webcam combined with a microphone which might have interfered with the leJos API. But the third camera we tested was succesfull in both the leJos and OpenCV API's. 

After identifying a working camera some demo programs were written to get a sense of the capabilities of using a webcam on the EV3. And to test wether or not there were any potential performance benefits in choosing one API over the other. 

### Demo programs
The first demo program conducted was to have the EV3 grap frames from the camera and display on the Monochrome LCD on the EV3. In doing this activity the group relaised that there are some important performance conciderations to concider when choosing which image format the camera data should be converted to. The leJos community claimed that JPEG is very cost ineffecient for the EV3, where as YUYV very cost effecient for the EV3. The group tried both in this demo program, and there was a small barely noticeable difference in response time on the video feed in favoure of YUYV. But this claims should be tested in more depth when working with the actual model for MI, since the claims of the leJos community is that YUYV is perferable over everything else when it comes to Computer Vision.

The second demo program conducted was to have the EV3 livestream the video feed over http via a bluetooth connection. This was to see how converting the camera data to JPEG affected the system, while the using the Bluetooth protocol to communicate. The test showed a high latency, almost unusable when using the leJos API and JPEG. But switching to OpenCV API and utilizing their Mat-datatype for representing the image significtly decreased the latency, to a point that the it became somewhat useable. Because of the noticable different between leJos API and OpenCV API, the group should conduct some expirements with OpenCV to recognize wether or not there are any performance to be gain by using that over leJos API.

Finally the group did a quick and dirty test to count the FPS from using the leJos API to grap frames and nothing else. That yielded a result between 14-15 fps, which in theory should be enough. But that test should be revisisted when the MI models complexity is accounted for, and tested on both the leJos API and OpenCV API.


[^Webcam_with_Lego_Mindstorms_EV3]: Webcam with Lego Mindstorms EV3, part 1 (kernel): http://gjf2a.blogspot.com/2014/08/webcam-with-lego-mindstorms-ev3-part-1.html
[^lejos_091_release]: The long waitâ€¦.:https://lejosnews.wordpress.com/2015/11/16/the-long-wait/
